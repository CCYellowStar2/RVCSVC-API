# 使用说明 📖

## 🚦 启动顺序

**重要：必须按以下顺序启动**

1. 先启动 **RVC WebUI** 或 **SVC WebUI**
2. 再启动对应的 **API 服务**（`app_rvc.py` 或 `app_svc.py`）

## ⚙️ 端口配置

如果你修改了 RVC/SVC 的默认端口，需要在对应的 API 文件中修改配置：

**RVC 版本 (app_rvc.py)**
```python
# 文件顶部
RVC_API_BASE = "http://127.0.0.1:7897" # 改为你的端口
```

**SVC 版本 (app_svc.py)**
```python
# 文件顶部
SVC_API_BASE = "http://127.0.0.1:7865" # 改为你的端口
```

## 🔧 SVC 特殊配置

使用 SVC API 前，需要将本项目提供的文件替换到 so-vits-svc 根目录中。

**重要：** 在 SVC WebUI 中切换到 **"独立目录模式"** 才能正常使用 API。

## 📂 文件存放规范

### RVC 模型文件结构

```
RVC项目路径/
├── assets/
│ └── weights/
│ ├── yuki.pth ✅ 模型文件直接放这里
│ ├── aoi.pth
│ └── karen.pth
│
└── logs/
├── yuki.index ✅ Index 文件直接放这里
├── aoi.index
└── karen.index
```

#### ⚠️ 常见错误

❌ **错误做法：**
```
assets/weights/yuki/yuki.pth # 不要在里面再建文件夹
logs/yuki/added_IVF4949_Flat_nprobe_1_yuki.index # 不要保留训练时的完整名称
```

✅ **正确做法：**
```
assets/weights/yuki.pth # 直接放在 weights 文件夹
logs/yuki.index # 重命名为与模型名一致
```

#### 📝 Index 文件重命名步骤

训练完成后，Index 文件通常在：
```
logs/模型名/added_IVF4949_Flat_nprobe_1_模型名.index
```

**操作步骤：**
1. 将 `added_IVF4949_Flat_nprobe_1_yuki.index` 移动到 `logs/` 目录
2. 重命名为 `yuki.index`（与模型名保持一致）

---

### SVC 模型文件结构

```
SVC项目路径/
├── models/
│ ├── aoi.pth ✅ 主模型直接放这里
│ ├── aoi.json ✅ 配置文件直接放这里
│ ├── karen.pth
│ ├── karen.json
│ │
│ └── diffusion/
│ ├── aoi.pt ✅ 扩散模型放这里
│ ├── aoi.yaml ✅ 扩散配置放这里
│ ├── karen.pt
│ └── karen.yaml
```

#### ⚠️ 注意事项

- ❌ 不要在 `models/` 或 `models/diffusion/` 里再创建子文件夹
- ✅ 所有文件名尽量保持一致（如 `aoi.pth`、`aoi.json`、`aoi.pt`）
- ✅ 程序会通过模糊匹配自动关联同名文件

---

## 🌐 API 接口说明

本项目开放以下 API 端点：

| API 名称 | 功能 | 说明 |
|---------|------|------|
| `/show_model` | 获取模型列表 | 返回当前可用的所有模型 |
| `/convert` | 执行翻唱转换 | 自动加载指定模型并完成转换 |

其他自动生成的 API 端点可以忽略。

### 查看完整 API 文档

启动服务后，访问 WebUI 底部的 **"通过 API 使用"** 链接查看详细调用方法。

---

## ✅ 检查清单

启动前请确认：

- [ ] RVC/SVC WebUI 已启动
- [ ] 端口配置正确
- [ ] 模型文件已按规范放置（无多余文件夹嵌套）
- [ ] Index 文件已重命名（与模型名一致）
- [ ] SVC 已切换到"独立目录模式"（仅 SVC 需要）
- [ ] UVR5 模型已下载到 `uvr5/uvr_model/` 目录

完成以上步骤后即可正常使用 API 服务。
